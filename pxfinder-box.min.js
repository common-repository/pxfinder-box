(function(a){a.fn.pfb=function(){var k=function(){var a=navigator.userAgent;return 0<a.indexOf("iPhone")||0<a.indexOf("Android")?!0:!1},g=this,c,h=this.length,m=a("body");a(" > *",m);var l=a("<div />").attr("id","pfb_overlay"),b=a("<img />").attr("id","pfb_current"),d='<svg id="pfb_loader" width="120" height="1" xmlns="http://www.w3.org/2000/svg"><rect x="0" y="0" width="0" height="1" fill="#cccccc" fill-opacity="0.5"><animate id="start" attributeName="x" attributeType="xml" from="0" to="0" dur="0.4s" begin="0s;end.end" /><animate attributeName="width" attributeType="xml" from="0" to="120" dur="0.4s" begin="0s;end.end" /><animate id="end" attributeName="x" attributeType="xml" from="0" to="120" dur="0.4s" begin="start.end" /><animate attributeName="width" attributeType="xml" from="120" to="0" dur="0.4s" begin="start.end" /></rect></svg>',
d=a(d),e;k()?m.append(l,b,d):(e='<ul id="pfb_nav"><li id="pfb_prev"><span class="icon-left"></span></li><li id="pfb_next"><span class="icon-right"></span></li><li id="pfb_close"><span class="icon-close"></span></li></ul>',e=a(e),m.append(l,b,d,e));b.on("load",function(){d.fadeOut("fast");n(b);b.fadeIn("slow");k()||e.fadeIn()});a("#pfb_next").on("click",function(){if(0.7>b.css("opacity"))return!1;c<h-1&&(d.fadeIn("fast"),c++,b.fadeOut("slow",function(){b.attr("src",g[c])}),a("#pfb_next, #pfb_prev").css("opacity",
1));c>h-2&&a(this).css("opacity",0.4)});a("#pfb_prev").on("click",function(){if(1!=b.css("opacity"))return!1;0<c&&(d.fadeIn("fast"),c--,b.fadeOut("slow",function(){b.attr("src",g[c])}),a("#pfb_next, #pfb_prev").css("opacity",1));1>c&&a(this).css("opacity",0.4)});a("#pfb_current, #pfb_close").on("click",function(){if(1!=b.css("opacity"))return!1;b.fadeOut("slow");k()||e.fadeOut();l.fadeOut()});g.on("click",function(){c=g.index(this);a("#pfb_next, #pfb_prev").css("opacity",1);1!=h?0==c?a("#pfb_prev").css("opacity",
0.4):c==h-1&&a("#pfb_next").css("opacity",0.4):a("#pfb_next, #pfb_prev").css("opacity",0.4);b.attr("src",this.href);b.get(0).complete?(n(b),b.fadeIn("slow"),k()||e.fadeIn()):d.fadeIn("fast");l.fadeIn();return!1});var n=function(b){var c=b.width(),f=b.height(),d,e,g=document.documentElement.clientWidth,h=document.documentElement.clientHeight;k()?b.css({position:"absolute",top:a(document).scrollTop(),marginTop:(window.innerHeight-f)/2,marginLeft:0}):(c>f?(d="50%",e=0,f=f/2*-1,c=(g-c)/2):(c<f?(d=0,e=
"50%",f=(h-f)/2):(e=d="50%",f=f/2*-1),c=c/2*-1),b.css({top:d,left:e,marginTop:f,marginLeft:c}))}}})(jQuery);